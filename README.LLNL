-----------------------------------------------------------------------------
Checking out Parflow from the SVN repository
-----------------------------------------------------------------------------

The environmental variable PARFLOW_DIR should be set to the place to
install the parflow executables and libraries.  See README.

-----------------------------------------------------------------------------
Checking out Parflow from the SVN repository
-----------------------------------------------------------------------------

cd <somewhere>
svn co svn+ssh://atlas/usr/gapps/thcs/subversion/parflow/trunk parflow


-----------------------------------------------------------------------------
Checking out WRF from the SVN repository
-----------------------------------------------------------------------------

cd <somewhere>
svn co svn+ssh://atlas/usr/gapps/thcs/subversion/wrf/trunk wrf

-----------------------------------------------------------------------------
Environmental variables
-----------------------------------------------------------------------------

SILO_DIR=/usr/gapps/silo/4.6.1/chaos_4_x86_64
HYPRE_DIR=/usr/casc/samrai/hypre/hypre-2.4.0b-atlas-gcc/
export SILO_DIR HYPRE_DIR

or use setenv if using csh/tcsh

setenv SILO_DIR /usr/gapps/silo/4.6.1/chaos_4_x86_64
setenv HYPRE_DIR /usr/casc/samrai/hypre/hypre-2.4.0b-atlas-gcc/

-----------------------------------------------------------------------------
Compiling Parflow on Atlas
-----------------------------------------------------------------------------

CC=gcc
F90=gfortran
F77=gfortran
export CC F90 F77

# Make Parflow
DIR=parflow
./configure \
                     --with-amps=mpi1 \
		     --with-silo=$SILO_DIR \
		     --with-hypre=$HYPRE_DIR \
                     --prefix=$PARFLOW_DIR
make -j 8 install

# Make pftools
DIR=pftools
./configure \
                     --with-amps=mpi1 \
		     --with-silo=$SILO_DIR \
                     --prefix=$PARFLOW_DIR

make -j 8 install

-----------------------------------------------------------------------------
Compiling WRF on Atlas
-----------------------------------------------------------------------------

cd <somewhere>/wrf
./configure

	Select option 3           PGI with GNU
	Select option 1 <basic - the default>

./compile wrf

-----------------------------------------------------------------------------
Compiling Parflow on CASC Tux Cluster
-----------------------------------------------------------------------------

The system MPI is not compiled for F90 so a different MPI is used that
is compiled with F90 support.

# Setup the MPI environment
. /usr/casc/samrai/openmpi/openmpi-1.2.6/setup.sh

cd <somewhere>/parflow
sh misc/build_scripts/build.parflow.tux

-----------------------------------------------------------------------------
Compiling WRF on CASC Tux cluster
-----------------------------------------------------------------------------

cd <somewhere>/wrf
./configure

	Select option 9 <gfortran compiler with gcc (dmpar)>
	Select option 1 <basic - the default>

./compile wrf

-----------------------------------------------------------------------------
Runing WRF+PF test case on CASC Tux cluster
-----------------------------------------------------------------------------

cd <somewhere>/wrf/parflow

mpirun -np 8 wrf_atlas.msub

NOTE: Need to run with the OpenMPI as above! Not MPICH in /usr/apps.






